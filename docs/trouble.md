故障排除
========

!!! tip "硬件损坏的可能性极小，99%的问题都可以通过[刷写完整固件修复](upgrade.md#CMSIS-DAP烧录工具更新)，如无法确定什么问题，可以无脑先下载CMSIS-DAP刷机包先[刷写完整固件修复](upgrade.md#CMSIS-DAP烧录工具更新)尝试是否可以修复问题"

通用故障排除指南
---------------------

如果你的键盘遇到了无法正常工作的问题，请按下列步骤依次进行排查：

1. 首先我们判断键盘故障点，通过观察指示灯判断键盘工作情况：
    -  如果插入USB线后，亮USB工作指示灯，说明键盘基本没有问题，请参考本页面下的具体情形进行处理
    -  如果指示灯无任何指示，请先确认指示灯处于开启状态，否则考虑是否固件刷写失败或键盘已经损坏
2. 如指示灯无任何指示，可按照以下步骤检查键盘硬件是否损坏：
    - 将键盘使用USB连接到电脑，观察电脑的设备状态和键盘的工作状态指示灯。
    - 若电脑设备列表能显示USB键盘，并且USB状态灯亮起的话，则说明蓝牙主控和USB芯片两个硬件均没有损坏。
    - 若电脑未发现USB键盘，而能搜索到蓝牙键盘，则说明至少蓝牙主控没有损坏，USB芯片可能存在问题。
    - 若电脑能发现USB键盘，而USB状态灯未亮起，同时无法搜索到蓝牙键盘的话，则说明USB芯片应该没有损坏，蓝牙主控可能有问题。
    - 硬件损坏的可能性极小，上述所说的损坏/问题，也可能仅是软件问题，而不是硬件损坏。
3. 如果第一步中指示灯无指示，但是第二步中判断出USB芯片没有问题：
    -  检查是否正确通电，如果未正确通电，应当解决通电问题
    -  正确通电的情况，请尝试正确唤醒键盘，最简单的方式是插入USB线 或 按击PCB背部按钮
    -  如果指示灯还是无任何指示，可以尝试刷写`完整蓝牙固件`修复键盘 [如何修复键盘](upgrade.md#CMSIS-DAP烧录工具更新)
    -  如果刷写`完整蓝牙固件`时找不到键盘，排除连接问题后，可能是蓝牙主控或USB主控已经损坏（硬件损坏的可能性极小）。
4. 如第二步中判断出USB芯片存在问题：
    -  可尝试重新刷写USB芯片，如能正常刷写USB芯片，可返回第二步再次进行判断
    -  如无法刷写USB芯片，可能USB芯片损坏
5. 如还无法解决故障，请[联系我们](index.md#联系我们)。

<span id="USB或蓝牙无法正常输出按键">USB或蓝牙无法正常输出按键</span>
-------------------
请按照以下步骤解决：

1. 如果是USB无法输出按键，请先确认使用的是数据线而不是充电线。
    - 分清数据线与充电线：数据线与充电线是不同的，充电线仅仅能充电，数据线才能传输数据正常工作。
    - 原装手机线一般是数据线，淘宝购买的线请与卖家确定支持数据传输。

2. 如果蓝牙无法正常输出，首先请确认正确进行了[绑定设备](manual.md#绑定设备)，如绑定后也无法正常输出，请参考：[如何改善蓝牙连接稳定性](faq.md#如何改善蓝牙连接稳定性)
   
3. 如果是升级新固件后导致的,请查阅[升级固件后键盘无法正常工作](#升级固件后键盘无法正常工作)
     
4. 如果上述步骤还无法解决问题，可以尝试: [重置键盘](faq.md#如何重置键盘) 或 尝试更新`完整蓝牙固件`进行修复

<span id="升级固件后键盘无法正常工作">升级固件后键盘无法正常工作</span>
-------------------
如刷写固件后指示灯未正常运作、无法输出按键 或 输出按键与实际按键不符，可考虑固件刷写出错

1. 确保固件正确刷入键盘
    - 如指示灯未能工作，如亮起或闪烁，可认为固件未正确刷入键盘。
    - 蓝牙固件有机率刷写失败，可以尝试重新刷写固件。
    - 如果指示灯能正常运作，方可确认蓝牙固件刷写正确。

2. 确保固件是正确的对应的固件
    - 可能是下载的固件不对应，比如下载了其他键盘的固件，或者固件的版本不对应。
    - 如键盘是Omega50，却升级了Omega45的键盘固件
    - 如键盘是Farad rev.B版，却升级了Farad rev.A的键盘固件
    - 请更新正确的固件即可解决问题。

3. 如固件刷写正确、无误
    - 升级USB固件后，将电脑上的USB设备删除，并重新插入USB线进行识别及驱动安装。
    - 升级蓝牙固件后，将电脑上的蓝牙设备删除，并将键盘上的绑定清空，然后重新进行绑定。
    - 如还无法解决问题，可考虑勾选烧录工具中"烧录时擦除蓝牙固件"选项，并更新`完整蓝牙固件`进行修复

<span id="升级固件后键盘无法正常工作">我的键盘无法开机了</span>
-------------------
观察指示灯，如键盘无指示灯工作，可能是键盘未能正常开机

1. 确保键盘有正常供电，如插入USB线进行供电、电池充电后使用、确保电池接口正负极正确。

2. 如有电状态无法正常开机，老硬件可以尝试：[强制进入DFU](faq.md#如何进入DFU模式)，然后更新最新的固件。

3. 如有电状态无法正常开机，支持线刷的新键盘可以尝试重新更新固件，甚至更新完整蓝牙固件进行修复。

4. 如蓝牙升级失败导致的，仅需要确保蓝牙固件正确，然后重新更新固件即可。

<span id="按键混乱，或按键无响应">按键混乱，或按键无响应</span>
------------------------

注:所谓按键混乱，是指按A出Z，按B出Q这种无规律的输出错误。

按键错乱或按键无响应一般是软故障，请按照以下步骤检查：

1. 如果是升级固件后导致的，可能是下载的固件不对应，比如下载了其他键盘的固件，或者固件的版本不对应。
    - 如键盘是Omega50，却升级了Omega45的键盘固件
    - 如键盘是Farad rev.B版，却升级了Farad rev.A的键盘固件

    上述故障请更新正确的固件。

2. 如果没有升级固件，可能是选择了不正确的默认层。可以尝试`恢复默认层`的设置：先 :`休眠键盘`，再`唤醒键盘`，即可恢复默认层。

3. 如果`恢复默认层`无效，或者按键无响应。可以尝试[重置键盘](faq.md#如何重置键盘)

4. 上述无法解决的话，支持线刷的新键盘可以尝试勾选烧录工具中"烧录时擦除蓝牙固件"选项，并更新`完整蓝牙固件`进行修复。

<span id="升级固件后键盘无法正常工作">按键串键，自动输出按键</span>
------------------------

注:所谓按键串键，是指按A出QAZ多个按键，按E出EDC多个按键这种一个键触发多个按键的情况。

按键串键一般是硬件故障，请按照以下步骤检查：

1. 如果您使用的金属壳，请做好金属壳与PCB上元件裸漏部分的绝缘。
    - 最简单的判断是否金属壳导致的串键方式：将PCB从金属外壳中取出，看是否还有串键情况。
    - 如GH60的金属外壳，GH两个按键之间的螺丝柱就极易导致金属短接。
    - 金属壳，主要检查螺丝柱、支撑点这些突起部分与PCB裸漏部分是否会短接。

2. 如果没有使用金属壳，可以用肉眼观察一下蓝牙主控部分（PCB上带金属屏蔽壳的大模块）的针脚之间是否有短接；各个元件之间是否因为某些原因导致短接。

3. 如果上述方式无法确认问题的话，也可能是因为线路短接、静电击毁等原因导致蓝牙故障，请[联系我们](index.md#联系我们)。


<span id="更新配列后所有按键失效">更新配列后所有按键失效</span>
--------------------------

可以尝试[重置键盘](faq.md#如何重置键盘)


<span id="Windows下出现“驱动程序错误”">Windows下出现“驱动程序错误”</span>
-----------------------------

1. 在Windows的设备管理器中删除这个设备，或取消这个设备的绑定
2. 重启你的电脑
3. `清空键盘绑定信息`
4. 在电脑上尝试重新连接

<span id="无法搜索到蓝牙键盘">无法搜索到蓝牙键盘</span>
----------------------
1. 确保键盘正常通电，是否通电可以通过观察是否有指示灯正常闪烁或曾经闪烁进行确认。
2. 如果您已经绑定了一个设备，第二个设备搜索不到蓝牙键盘。
    - 先阅读学习[绑定设备](manual.md#绑定设备) 的相关操作。
    - 已经绑定一个设备后，如果第二个设备要搜索到蓝牙键盘，必须切换到未绑定的蓝牙通道并广播。
    - 如果要在当前蓝牙通道进行搜索绑定，您需要先清空当前通道绑定的设备后，然后再进行搜索。
3. 如果是键盘开机或唤醒后放置了一段时间后无法搜索到蓝牙键盘，您只需要同时按下<kbd>Lshift</kbd>+<kbd>Rshift</kbd>+<kbd>R</kbd>重新开启蓝牙广播，即可搜索到蓝牙键盘。

<span id="蓝牙设备不停已配对/已连接">蓝牙设备不停已配对/已连接</span>
-------------------
可能是绑定信息因为误操作，重置键盘等被删除，只需要删除电脑等设备上的绑定信息后，重新[绑定设备](manual.md#绑定设备)即可解决。 

<span id="蓝牙状态偶尔出现卡键">蓝牙状态偶尔出现卡键</span>
-----------------------
所谓卡键，就是某一个按键一直处于按下状态（不停输出），但实际并未按下。

这是蓝牙信号不好，导致信号中断后，电脑认为按键一直处于按下状态的原因。

请参考问答解决：[如何改善蓝牙连接稳定性](faq.md#如何改善蓝牙连接稳定性)

<span id="蓝牙状态偶尔出现按键无效">蓝牙状态偶尔出现按键无效</span>
-----------------------

可能是蓝牙信号不好，导致蓝牙断开连接，无法正常输出按键。

请参考问答解决：[如何改善蓝牙连接稳定性](faq.md#如何改善蓝牙连接稳定性)

<span id="指示灯忽然亮起蓝牙广播指示灯">指示灯忽然亮起蓝牙广播指示灯</span>
----------------------------------------

这是蓝牙信号不好，蓝牙断开连接后马上又恢复连接的表现。

请参考问答解决：[如何改善蓝牙连接稳定性](faq.md#如何改善蓝牙连接稳定性)

<span id="配置工具无法识别键盘">配置工具无法识别键盘</span>
------------------

配置工具无法识别，请按下列步骤解决：

1. 必须开启客户端：lkb-configurator-server [前往下载](down/download.md)

2. 不要使用USB集线器，直接将键盘线插入电脑USB口

3. 开启配置工具的同时，在浏览器中访问http://localhost:5000/api/device
    - (1).如果显示：无法访问此页面，说明配置工具没有正常启用
    - (2).如果显示：[]，说明配置工具正常，但是键盘未被识别
    - (3).如果显示：[{"id":"4992B144","vid":17254,....]，说明键盘正确识别

4. 安装版配置工具显示空白页面 或 其他访问异常
    - 请首先确保电脑正常联网，并关闭代理、防火墙等，使配置工具可正常访问网络
    - 如无法确认情况，但属于第5条第(3)种情况，可在开启配置工具的同时，浏览器访问keyboard.lotlab.org。

5. 如PCB较为老旧（2020年6月之前购买），您需要先升级固件
    - 升级蓝牙固件：访问 [相关下载](down/download.md) 下载新版固件，然后 [更新蓝牙固件](upgrade.md#更新蓝牙固件)
    - 如果升级蓝牙固件后可以识别，不需要升级USB固件，如果还是无法识别，请[升级USB固件](upgrade.md#更新USB固件)，并删除电脑上USB键盘，重新插入键盘识别
